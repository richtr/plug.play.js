{"body":"Plug.Play.js is a JavaScript API for communicating with Universal Plug and Play (UPnP) Services obtained via the [W3C Network Service Discovery draft specification (4th October 2012 version)](http://www.w3.org/TR/2012/WD-discovery-api-20121004/).\r\n\r\n### Setup\r\n\r\nThis API requires a web browser that supports [<code>navigator.getNetworkServices</code>](http://www.w3.org/TR/2012/WD-discovery-api-20121004/#dom-navigator-getnetworkservices).\r\n\r\nOpera [released a Labs build](http://dev.opera.com/articles/view/network-service-discovery-api-support-in-opera/) that provides support for this API. You can read more and download the browser builds at the [Dev.Opera blog](http://dev.opera.com/articles/view/network-service-discovery-api-support-in-opera/).\r\n\r\n#### Download this library\r\n\r\nYou can download a [ZIP](https://github.com/richtr/plug.play.js/zipball/master) or [TAR.GZ](https://github.com/richtr/plug.play.js/tarball/master) file containing all the Plug.Play library code or you can clone this repo via Git as follows:\r\n\r\n    git clone git://github.com/richtr/plug.play.js.git\r\n\r\nTo get started, a UPnP service demo ([example.html](https://github.com/richtr/plug.play.js/blob/master/example.html)) is available and a [test suite](https://github.com/richtr/plug.play.js/blob/master/test) is also included for checking the validity of the API.\r\n\r\n### Work flow\r\n\r\nPlug.Play is an API to make working with UPnP Services simple and easy.\r\n\r\nThe basic work flow for using this API is as follows:\r\n\r\n1. Obtain one or more [<code>NetworkService</code>](http://www.w3.org/TR/2012/WD-discovery-api-20121004/#networkservice) objects via [<code>navigator.getNetworkServices</code>](http://www.w3.org/TR/2012/WD-discovery-api-20121004/#dom-navigator-getnetworkservices).\r\n2. Create a new <code>Plug.UPnP</code> object for each [<code>NetworkService</code>](http://www.w3.org/TR/2012/WD-discovery-api-20121004/#networkservice) object returned.\r\n3. Invoke UPnP Service Actions via the <code>Plug.UPnP</code> object's <code>.action()</code> API method.\r\n\r\nEach step above is explained in more detail below.\r\n\r\n#### Step 1: Obtain <code>NetworkService</code> objects\r\n\r\nIf you are running this API in a supported browser, as discussed in the [Setup](#setup) section above, you will be able to obtain a set of [<code>NetworkService</code>](http://www.w3.org/TR/2012/WD-discovery-api-20121004/#networkservice) objects as follows:\r\n\r\n    if(navigator.getNetworkServices) {\r\n      navigator.getNetworkServices(\r\n        'upnp:urn:schemas-upnp-org:service:RenderingControl:1',\r\n        successCallback\r\n      );\r\n    }\r\n\r\nThe <code>successCallback</code> function takes one argument, a [<code>NetworkServices</code>](http://www.w3.org/TR/2012/WD-discovery-api-20121004/#networkservices) object that acts like an array of [<code>NetworkService</code>](http://www.w3.org/TR/2012/WD-discovery-api-20121004/#networkservice) objects. When services are found in the current network that match the requested service type(s) the web browser will trigger execution of this function.\r\n\r\n    function successCallback( servicesManager ) {\r\n      // Dump services to console\r\n      for( var i = 0; i < servicesManager.length; i++ ) {\r\n        console.log( \"Service w/ type [\" +\r\n                        servicesManager[i].type  + \"] available\" );\r\n      }\r\n    }\r\n\r\n#### Step 2: Create a new <code>Plug.UPnP</code> object\r\n\r\nOnce we have a <code>successCallback</code> function defined, we can create new <code>Plug.UPnP</code> objects.\r\n\r\nTo create a new <code>Plug.UPnP</code> object we need pass in a single (UPnP-based) [<code>NetworkService</code>](http://www.w3.org/TR/2012/WD-discovery-api-20121004/#networkservice)\r\nobject as the first argument.\r\n\r\n    var upnpService = new Plug.UPnP( servicesManager[i] );\r\n\r\nHere's a full example, expanding and replacing the <code>successCallback</code> function we defined earler:\r\n\r\n    function successCallback( servicesManager ) {\r\n\r\n      // Create a new UPnP object for each service returned\r\n      var upnpServices = [];\r\n\r\n      for( var i = 0; i < servicesManager.length; i++ ) {\r\n\r\n        upnpServices.push(\r\n          new Plug.UPnP( servicesManager[i] );\r\n        );\r\n\r\n        // doUPnPGetMute code provided in Step 3...\r\n        doUPnPGetMute( upnpServices[ upnpServices.length - 1 ] );\r\n\r\n      }\r\n\r\n    }\r\n\r\nYou can optionally, include a second argument to this constructor to override the default <code>Plug.UPnP</code> options:\r\n\r\n    new Plug.UPnP( servicesManager[i], { debug: true } );\r\n\r\nThe current list of values that can be provided in the options argument are as follows:\r\n\r\n###### debug\r\n\r\n_Boolean. Whether to spit out more debug messages to the console. Useful when debugging errors in your web app._\r\n\r\n#### Step 3: Invoke UPnP actions and process UPnP responses\r\n\r\nThe Plug.Play API is built to work on top of [rsvp.js](https://github.com/tildeio/rsvp.js) and therefore provides a  [Promises/A](http://wiki.commonjs.org/wiki/Promises/A)-based interaction model. As part of the Promises model this API supports [method chaining](https://github.com/kriskowal/q#chaining) and [promise sequences](https://github.com/kriskowal/q#sequences).\r\n\r\nHere is a simple example of querying the mute state of a UPnP RenderingControl:1 service on a created <code>Plug.UPnP</code> object called <code>upnpService</code>:\r\n\r\n    function doUPnPGetMute( upnpService ) {\r\n\r\n      upnpService.action('GetMute', {\r\n        InstanceId: 0,\r\n        Channel: 'Master'\r\n      })\r\n      .then(function( response ) {\r\n\r\n        console.log(\"Service is reporting MUTE=[\" +\r\n          (response.data.CurrentMute == \"1\" ? 'on' : 'off' +\r\n            \"]\");\r\n\r\n      })\r\n      .then( null, function( error ) { // All errors will propagate here\r\n\r\n        console.log( error.description );\r\n\r\n      });\r\n\r\n    }\r\n\r\nThe Plug.Play library also comes with some convenience classes for particular service types. The demo provided above can also be written against the well-defined [UPnPRenderingControl API](https://github.com/richtr/plug.play.js/tree/master/lib/RenderingControl) also included in this repository. More service-specific wrappers will be added to this repository soon.\r\n\r\n### Advanced Usage\r\n\r\n##### Type Checking & Conversion\r\n\r\nYou can enforce type checking and type conversion controls in this API according to the data types defined for UPnP in the [UPnP Device Architecture specification](http://upnp.org/specs/arch/UPnP-arch-DeviceArchitecture-v1.1.pdf).\r\n\r\nThe following code is equivalent to the doUPnPGetMute() function defined above but this time we enforce the variable types and constrain inputs to a series of allowed value types for each input variable:\r\n\r\n    function doUPnPGetMute( upnpService ) {\r\n\r\n      upnpService.action('GetMute', {\r\n        InstanceId: {\r\n          type: upnpService.types.ui4, // or just write 'ui4'\r\n          value: 0\r\n        },\r\n        Channel: {\r\n          type: upnpService.types.string, // or just write 'string'\r\n          value: 'Master',\r\n          allowedValueList:\r\n            ['Master', 'LF', 'RF', 'CF', 'LFE', 'LS', 'RS',\r\n                'LFC', 'RFC', 'SD', 'SL', 'SR', 'T', 'B']\r\n        }\r\n      })\r\n      .then(function( response ) {\r\n\r\n        console.log(\"Service is reporting MUTE=[\" +\r\n          (response.data.CurrentMute == \"1\" ? 'on' : 'off' +\r\n            \"]\");\r\n\r\n      })\r\n      .then( null, function( error ) {\r\n\r\n        console.log( \"An error occurred: \" + error.description );\r\n\r\n      });\r\n\r\n    }\r\n\r\nFurthermore, we can use the same structure to enforce variable type conversion on UPnP message response objects. This is useful in particular where we need or want to convert XML types to native JavaScript object types (such as booleans, numbers or dates).\r\n\r\nTo do this we supply a more structured argument consisting of two parts: <code>request</code> parameters and <code>response</code> parameters. We assign our type checking/conversion rules as required in this structure:\r\n\r\n    function doUPnPGetMute( upnpService ) {\r\n\r\n      upnpService.action('GetMute', {\r\n        request: {\r\n          InstanceId: {\r\n            type: upnpService.types.ui4,\r\n            value: 0\r\n          },\r\n          Channel: {\r\n            type: upnpService.types.string,\r\n            value: 'Master',\r\n            allowedValueList:\r\n              ['Master', 'LF', 'RF', 'CF', 'LFE', 'LS', 'RS',\r\n                  'LFC', 'RFC', 'SD', 'SL', 'SR', 'T', 'B']\r\n          }\r\n        },\r\n        response: {\r\n          CurrentMute: {\r\n            type: upnpService.types.boolean,\r\n            value: false // default response value if\r\n                         // none is provided (optional)\r\n          }\r\n        }\r\n      })\r\n      .then( function( response ) {\r\n\r\n        // Note: we no longer need to check for '== \"1\"' below because\r\n        // response.data.CurrentMute is now a native JS boolean as we\r\n        // defined in our <actionParameters> above:\r\n\r\n        console.log(\"Service is reporting MUTE=[\" +\r\n          (response.data.CurrentMute ? 'on' : 'off') +\r\n            \"]\");\r\n\r\n      }, function( error ) { // Handle any errors\r\n\r\n        console.log( \"An error occurred: \" + error.description );\r\n\r\n      });\r\n\r\n    }\r\n\r\nPlug.Play API calls can be [chained](https://github.com/kriskowal/q#chaining) as follows:\r\n\r\n    function doUPnPGetThenSetThenGetMute( upnpService ) {\r\n\r\n      upnpService.action('GetMute', {\r\n        request: {\r\n          InstanceId: 0,\r\n          Channel: 'Master'\r\n        },\r\n        response: {\r\n          CurrentMute: {\r\n            type: upnpService.types.boolean\r\n          }\r\n        }\r\n      })\r\n      .then( function( response ) {\r\n\r\n        console.log(\"Service is reporting MUTE=[\" +\r\n          (response.data.CurrentMute ? 'on' : 'off') +\r\n            \"]\");\r\n\r\n        return upnpService.action('SetMute', {\r\n          request: {\r\n            InstanceId: 0,\r\n            Channel: 'Master',\r\n            DesiredMute: response.data.CurrentMute ? 0 : 1\r\n          }\r\n        });\r\n\r\n      })\r\n      .then( function( response ) {\r\n\r\n        return upnpService.action('GetMute', {\r\n          request: {\r\n            InstanceId: 0,\r\n            Channel: 'Master'\r\n          },\r\n          response: {\r\n            CurrentMute: {\r\n              type: upnpService.types.boolean\r\n            }\r\n          }\r\n        })\r\n\r\n      })\r\n      .then( function( response ) {\r\n\r\n        console.log(\"Service is reporting MUTE=[\" +\r\n          (response.data.CurrentMute ? 'on' : 'off') +\r\n            \"]\");\r\n\r\n      })\r\n      .then( null, function( error ) { // Handle any errors\r\n\r\n        console.log( \"An error occurred: \" + error.description );\r\n\r\n      });\r\n\r\n    }\r\n\r\n##### UPnP data types\r\n\r\nThe list of valid UPnP data types are as follows:\r\n\r\n###### Plug.UPnP.prototype.types.i1\r\n\r\n_1 Byte int_\r\n\r\n###### Plug.UPnP.prototype.types.i2\r\n\r\n_2 Byte int_\r\n\r\n###### Plug.UPnP.prototype.types.i4\r\n\r\n_4 Byte int_\r\n\r\n###### Plug.UPnP.prototype.types.ui1\r\n\r\n_Unsigned 1 Byte int_\r\n\r\n###### Plug.UPnP.prototype.types.ui2\r\n\r\n_Unsigned 2 Byte int_\r\n\r\n###### Plug.UPnP.prototype.types.ui4\r\n\r\n_Unsigned 4 Byte int_\r\n\r\n###### Plug.UPnP.prototype.types.int\r\n\r\n_Fixed point, integer number that may have leading sign_\r\n\r\n###### Plug.UPnP.prototype.types.r4\r\n\r\n_4 Byte float_\r\n\r\n###### Plug.UPnP.prototype.types.r8\r\n\r\n_8 Byte float_\r\n\r\n###### Plug.UPnP.prototype.types.number\r\n\r\n_Same as <code>Plug.UPnP.prototype.types.r8</code>_\r\n\r\n###### Plug.UPnP.prototype.types.fixed\\_14\\_4\r\n\r\n_Same as <code>Plug.UPnP.prototype.types.r8</code> but no more than 14 digits to the left of the decimal point and no more than 4 to the right_\r\n\r\n###### Plug.UPnP.prototype.types.float\r\n\r\n_Floating point number (same as <code>Plug.UPnP.prototype.types.r8</code>)_\r\n\r\n###### Plug.UPnP.prototype.types.char\r\n\r\n_Unicode string. One character long_\r\n\r\n###### Plug.UPnP.prototype.types.string\r\n\r\n_Unicode string. No limit on length_\r\n\r\n###### Plug.UPnP.prototype.types.date\r\n\r\n_Date without time data (accepts ISO-8601 strings or Date objects and returns ECMA <code>Date</code> objects)_\r\n\r\n###### Plug.UPnP.prototype.types.dateTime\r\n\r\n_Date with optional time but no time zone (accepts ISO-8601 strings or Date objects and returns ECMA <code>Date</code> objects)_\r\n\r\n###### Plug.UPnP.prototype.types.dateTime\\_tz\r\n\r\n_Date with optional time and optional time zone (accepts ISO-8601 strings or Date objects and returns ECMA <code>Date</code> objects)_\r\n\r\n###### Plug.UPnP.prototype.types.time\r\n\r\n_Time with no date and no time zone (accepts ISO-8601 strings or Date objects and returns ECMA <code>Date</code> objects)_\r\n\r\n###### Plug.UPnP.prototype.types.time\\_tz\r\n\r\n_Time with optional time zone but no date (accepts ISO-8601 strings or Date objects and returns ECMA <code>Date</code> objects)_\r\n\r\n###### Plug.UPnP.prototype.types.boolean\r\n\r\n_<code>true</code> or <code>false</code> (accepts <code>'true'</code>, <code>'false'</code>, <code>'yes'</code>, <code>'y'</code>, <code>'no'</code>, <code>'n'</code> and returns ECMA <code>Boolean</code> objects)_\r\n\r\n###### Plug.UPnP.prototype.types.bin\\_base64\r\n\r\n_MIME-style Base64 encoded binary blob_\r\n\r\n###### Plug.UPnP.prototype.types.bin\\_hex\r\n\r\n_Hexadecimal digits representing octets_\r\n\r\n###### Plug.UPnP.prototype.types.uri\r\n\r\n_Universal Resource Identifier_\r\n\r\n###### Plug.UPnP.prototype.types.uuid\r\n\r\n_Universally Unique Identifier_\r\n\r\n### Feedback\r\n\r\nIf you find any bugs or issues please report them on the [Plug.Play Issue Tracker](https://github.com/richtr/plug.play.js/issues).\r\n\r\nIf you would like to contribute to this project please consider [forking this repo](https://github.com/richtr/plug.play.js/fork_select) and then creating a new [Pull Request](https://github.com/richtr/plug.play.js/pulls) back to the main code base.\r\n\r\n### License\r\n\r\nCopyright &copy; 2012 Opera Software ASA\r\n\r\nSee the [LICENSE](https://github.com/richtr/plug.play.js/blob/master/LICENSE) file.","google":"UA-2663988-10","tagline":"A Network Service Messaging framework for use on top of the W3C Network Service Discovery specification","note":"Don't delete this file! It's used internally to help with page regeneration.","name":"plug.play.js"}